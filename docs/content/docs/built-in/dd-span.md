---
# This file is generated by `go generate ./internal/injector/builtin`. DO NOT EDIT.
title: "//dd:span"
subtitle: "Monitor a function using a custom span."
icon: "cog"
---
Monitor a function using a custom span.

## Using context.Context

<div class="hextra-cards hx-mt-4 hx-gap-4 hx-grid" style="--hextra-cards-grid-cols: 1;">
  <div class="aspect hextra-card hx-group hx-flex hx-flex-col hx-justify-start hx-overflow-hidden hx-rounded-lg hx-border hx-border-gray-200 hx-text-current hx-no-underline dark:hx-shadow-none hover:hx-shadow-gray-100 dark:hover:hx-shadow-none hx-shadow-gray-100 active:hx-shadow-sm active:hx-shadow-gray-200 hx-transition-all hx-duration-200">
    <div>
      <span class="hextra-card-icon hx-flex hx-font-semibold hx-items-start hx-gap-2 hx-p-4 hx-text-gray-700 hover:hx-text-gray-900 dark:hx-text-neutral-200 dark:hover:hx-text-neutral-50">
        {{<iconSVG "search-circle">}} Join Point
      </span>
      <div class="root hextra-card-subtitle hx-font-normal hx-px-4 hx-mb-4 hx-mt-2"><div class="join-point function-body"><span class="type pill">Function body</span><ul><li><div class="join-point function-declaratop,">
  <span class="type pill">Function declaration</span>
  <ul>
    <li>
<div class="flex join-point function-option fo-directive"><span class="type">Has directive</span><code>//dd:span</code></div>    </li>
    <li>
<div class="flex join-point function-option fo-receives"><span class="type">Has parameter</span>{{<godoc "context" "Context" "">}}</div>    </li>
  </ul>
</div>
</li></ul></div></div>
    </div>
    <div class="hx-border-t">
      <span class="hextra-card-icon hx-flex hx-font-semibold hx-items-start hx-gap-2 hx-p-4 hx-text-gray-700 hover:hx-text-gray-900 dark:hx-text-neutral-200 dark:hover:hx-text-neutral-50">
        {{<iconSVG "chip">}} Advice
      </span>
      <div class="hextra-card-subtitle hx-font-normal hx-px-4 hx-mb-4 hx-mt-2"><div class="advice prepend-statements"><div class="type">Prepend statements produced by the following template:</div>

```go
// Assuming the following imports:
import (
	event "github.com/datadog/orchestrion/instrument/event"
	instrument "github.com/datadog/orchestrion/instrument"
)
```

```go-template
{{- $ctx := .FindArgument "context.Context" -}}
{{- $name := .Function.Name -}}
{{$ctx}} = instrument.Report({{$ctx}}, event.EventStart{{with $name}}, "function-name", {{printf "%q" .}}{{end}}
{{- range .DirectiveArgs "dd:span" -}}
	, {{printf "%q" .Key}}, {{printf "%q" .Value}}
{{- end -}})
defer instrument.Report({{$ctx}}, event.EventEnd{{with $name}}, "function-name", {{printf "%q" .}}{{end}}
{{- range .DirectiveArgs "dd:span" -}}
	, {{printf "%q" .Key}}, {{printf "%q" .Value}}
{{- end -}})
```
</div></div>
    </div>
  </div>
</div>

## Using *http.Request

<div class="hextra-cards hx-mt-4 hx-gap-4 hx-grid" style="--hextra-cards-grid-cols: 1;">
  <div class="aspect hextra-card hx-group hx-flex hx-flex-col hx-justify-start hx-overflow-hidden hx-rounded-lg hx-border hx-border-gray-200 hx-text-current hx-no-underline dark:hx-shadow-none hover:hx-shadow-gray-100 dark:hover:hx-shadow-none hx-shadow-gray-100 active:hx-shadow-sm active:hx-shadow-gray-200 hx-transition-all hx-duration-200">
    <div>
      <span class="hextra-card-icon hx-flex hx-font-semibold hx-items-start hx-gap-2 hx-p-4 hx-text-gray-700 hover:hx-text-gray-900 dark:hx-text-neutral-200 dark:hover:hx-text-neutral-50">
        {{<iconSVG "search-circle">}} Join Point
      </span>
      <div class="root hextra-card-subtitle hx-font-normal hx-px-4 hx-mb-4 hx-mt-2"><div class="join-point function-body"><span class="type pill">Function body</span><ul><li><div class="join-point function-declaratop,">
  <span class="type pill">Function declaration</span>
  <ul>
    <li>
<div class="flex join-point function-option fo-directive"><span class="type">Has directive</span><code>//dd:span</code></div>    </li>
    <li>
<div class="flex join-point function-option fo-receives"><span class="type">Has parameter</span>{{<godoc "net/http" "Request" "*">}}</div>    </li>
  </ul>
</div>
</li></ul></div></div>
    </div>
    <div class="hx-border-t">
      <span class="hextra-card-icon hx-flex hx-font-semibold hx-items-start hx-gap-2 hx-p-4 hx-text-gray-700 hover:hx-text-gray-900 dark:hx-text-neutral-200 dark:hover:hx-text-neutral-50">
        {{<iconSVG "chip">}} Advice
      </span>
      <div class="hextra-card-subtitle hx-font-normal hx-px-4 hx-mb-4 hx-mt-2"><div class="advice prepend-statements"><div class="type">Prepend statements produced by the following template:</div>

```go
// Assuming the following imports:
import (
	event "github.com/datadog/orchestrion/instrument/event"
	instrument "github.com/datadog/orchestrion/instrument"
)
```

```go-template
{{- $req := .FindArgument "*net/http.Request" -}}
{{- $name := .Function.Name -}}
{{$req}} = {{$req}}.WithContext(instrument.Report({{$req}}.Context(), event.EventStart{{with $name}}, "function-name", {{printf "%q" .}}{{end}}
{{- range .DirectiveArgs "dd:span" -}}
	, {{printf "%q" .Key}}, {{printf "%q" .Value}}
{{- end -}}))
defer instrument.Report({{$req}}.Context(), event.EventEnd{{with $name}}, "function-name", {{printf "%q" .}}{{end}}
{{- range .DirectiveArgs "dd:span" -}}
	, {{printf "%q" .Key}}, {{printf "%q" .Value}}
{{- end -}})
```
</div></div>
    </div>
  </div>
</div>
